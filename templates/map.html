{% extends "base.html" %}

{% block title %}Карта преступности{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<link rel="stylesheet" href="{{ url_for('static', filename='css/map.css') }}">
{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="mb-0">Карта преступности ПМР по районам</h1>
    <button class="btn btn-primary" id="calculateBtn" onclick="calculateCrimeLevel()">
        <span id="calculateBtnText">Пересчитать уровень преступности</span>
        <span id="calculateSpinner" class="spinner-border spinner-border-sm ms-2 hidden"></span>
    </button>
</div>

<div class="text-center mb-3">
    <h4>Год: <span id="yearValue">2015</span></h4>
    <input type="range" class="form-range" id="yearSlider" min="2013" max="2025" value="2015" step="1">
</div>

<div class="map-container">
    <div id="map"></div>

    <div class="districts-panel card">
        <div class="card-body">
            <h5>Районы по уровню преступности</h5>
            <div id="districtsList"></div>
        </div>
    </div>
</div>

<div class="card mt-3">
    <div class="card-body">
        <h6>Легенда</h6>
        <div class="d-flex gap-3 flex-wrap">
            <div class="d-flex align-items-center">
                <div class="legend-color legend-color-low"></div>
                <span>Низкий (2-2.5)</span>
            </div>
            <div class="d-flex align-items-center">
                <div class="legend-color legend-color-medium"></div>
                <span>Средний (2.5-3)</span>
            </div>
            <div class="d-flex align-items-center">
                <div class="legend-color legend-color-elevated"></div>
                <span>Повышенный (3-4)</span>
            </div>
            <div class="d-flex align-items-center">
                <div class="legend-color legend-color-high"></div>
                <span>Высокий (4-5)</span>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="{{ url_for('static', filename='js/map.js') }}"></script>
{% endblock %}
